# Conventional Commits 기반 커밋 메시지 작성법

> **v1.0.0 표준 기반** - 2024년 업데이트

## 기본 구조

| 구성요소          | 설명                        | 필수여부 |
| ----------------- | --------------------------- | -------- |
| `<type>`          | 커밋 타입 (feat, fix 등)    | **필수** |
| `[scope]`         | 변경 범위 (괄호 안에 명시)  | 선택     |
| `!`               | 호환성을 깨뜨리는 변경 표시 | 선택     |
| `: <description>` | 콜론과 공백 후 간단한 설명  | **필수** |
| `[body]`          | 상세 설명 (빈 줄 후)        | **선택** |
| `[footer]`        | 푸터 정보 (빈 줄 후)        | **선택** |

**최소 형식**: `<type>: <description>`

**전체 형식**: `<type>[optional scope]: <description>`

```
[optional body]

[optional footer(s)]

```

> 💡 중요: 본문(body)과 푸터(footer)는 선택사항. 대부분의 커밋은 헤더만으로도 충분함.
> 

## 주요 커밋 타입

| 타입       | 설명                         | 시맨틱 버전 | 예시                             |
| ---------- | ---------------------------- | ----------- | -------------------------------- |
| `feat`     | 새로운 기능 추가             | MINOR       | `feat: 사용자 인증 기능 추가`    |
| `fix`      | 버그 수정                    | PATCH       | `fix: 로그인 문제 해결`          |
| `docs`     | 문서 변경                    | -           | `docs: API 문서 업데이트`        |
| `style`    | 코드 스타일 변경 (포맷팅 등) | -           | `style: 들여쓰기 수정`           |
| `refactor` | 코드 리팩토링                | -           | `refactor: 코드 구조 개선`       |
| `perf`     | 성능 개선                    | -           | `perf: 데이터베이스 쿼리 최적화` |
| `test`     | 테스트 추가/수정             | -           | `test: 인증 단위 테스트 추가`    |
| `chore`    | 기타 유지보수/정리 작업      | -           | `chore: 사용하지 않는 파일 정리` |
| `ci`       | CI 설정 변경                 | -           | `ci: GitHub Actions 업데이트`    |
| `build`    | 빌드 시스템 변경             | -           | `build: webpack 설정 업데이트`   |
| `revert`   | 이전 커밋 되돌리기           | -           | `revert: feat: 사용자 인증 기능` |

## 호환성을 깨뜨리는 변경 (BREAKING CHANGE)

| 표시 방법   | 형식                             | 시맨틱 버전 | 예시                                     |
| ----------- | -------------------------------- | ----------- | ---------------------------------------- |
| 타입 뒤 `!` | `<type>!: <description>`         | MAJOR       | `feat!: 폐기된 API 제거`                 |
| 푸터 사용   | `BREAKING CHANGE: <description>` | MAJOR       | `BREAKING CHANGE: API 엔드포인트 변경됨` |
| 둘 다 사용  | `<type>!: <description>` + 푸터  | MAJOR       | 위 두 방식 조합                          |

## 스코프 사용 예시

| 형식                          | 설명                  | 예시                              |
| ----------------------------- | --------------------- | --------------------------------- |
| `feat(parser): <description>` | parser 모듈의 새 기능 | `feat(parser): JSON 지원 추가`    |
| `fix(auth): <description>`    | auth 모듈의 버그 수정 | `fix(auth): null 토큰 처리`       |
| `docs(api): <description>`    | API 문서 업데이트     | `docs(api): 엔드포인트 예시 추가` |

## 푸터 형식

| 푸터 타입        | 형식                             | 예시                                |
| ---------------- | -------------------------------- | ----------------------------------- |
| 일반 푸터        | `<token>: <value>`               | `Reviewed-by: 홍길동`               |
| 일반 푸터 (해시) | `<token> #<value>`               | `Refs #123`                         |
| 호환성 깨뜨림    | `BREAKING CHANGE: <description>` | `BREAKING CHANGE: Node 6 지원 중단` |
| 복합 토큰        | `<token-name>: <value>`          | `Co-authored-by: 김영희`            |

## 커밋 메시지 예시 (간단 → 복잡)

### 1. 기본 형태 (헤더만)

| 구성요소 | 내용                   |
| -------- | ---------------------- |
| **헤더** | `feat: 다크 모드 추가` |

### 2. 스코프 포함

| 구성요소 | 내용                             |
| -------- | -------------------------------- |
| **헤더** | `feat(auth): OAuth2 로그인 구현` |

### 3. 호환성을 깨뜨리는 변경

| 구성요소 | 내용                                |
| -------- | ----------------------------------- |
| **헤더** | `feat!: 새 API 구조로 마이그레이션` |

### 4. 본문 포함 (선택사항)

| 구성요소 | 내용                                                                                                  |
| -------- | ----------------------------------------------------------------------------------------------------- |
| **헤더** | `fix: 이미지 처리 메모리 누수 해결`                                                                   |
| **본문** | `가비지 컬렉션이 제대로 동작하지 않는 문제를 수정. 이미지 로딩 후 참조를 명시적으로 해제하도록 변경.` |

### 5. 완전한 형태 (본문 + 푸터)

| 구성요소 | 내용                                                                                                                                                 |
| -------- | ---------------------------------------------------------------------------------------------------------------------------------------------------- |
| **헤더** | `feat(api): 사용자 프로필 엔드포인트 추가`                                                                                                           |
| **본문** | `사용자 프로필 정보를 조회하는 GET /api/users/:id 엔드포인트를 구현. 사용자 ID 매개변수 검증과 존재하지 않는 사용자에 대한 적절한 오류 처리를 포함.` |
| **푸터** | `Closes #456` <br> `Reviewed-by: 김영희`                                                                                                             |

### 6. Revert 커밋 예시

| 구성요소 | 내용                                                  |
| -------- | ----------------------------------------------------- |
| **헤더** | `revert: feat(auth): OAuth2 로그인 구현`              |
| **본문** | `이 커밋은 보안 이슈로 인해 OAuth2 기능을 임시 제거.` |
| **푸터** | `Refs: 676104e` <br> `Related to: #89`                |

## 실제 프로젝트 상황별 예시

### Frontend 개발

```
feat(ui): 상품 목록 페이지 추가
fix(components): 모달 창 닫기 버튼 오류 수정
style(css): 반응형 레이아웃 개선
refactor(hooks): 사용자 상태 관리 로직 최적화
```

### Backend 개발

```
feat(api): 주문 처리 엔드포인트 구현
fix(database): 연결 풀 메모리 누수 해결
perf(query): 상품 검색 쿼리 최적화
test(service): 결제 서비스 단위 테스트 추가
```

### DevOps 작업

```
ci: Docker 이미지 빌드 파이프라인 추가
build: Webpack 설정 업데이트
chore: 의존성 보안 패치 적용
```

## 명세 핵심 규칙

| 규칙              | 설명                                             |
| ----------------- | ------------------------------------------------ |
| **타입 필수**     | 모든 커밋은 반드시 타입으로 시작해야 함          |
| **콜론과 공백**   | 타입/스코프 뒤에는 반드시 `:`  (콜론+공백)       |
| **설명 필수**     | 콜론 뒤에는 반드시 설명이 와야 함                |
| **본문 선택사항** | 본문이 있다면 설명과 빈 줄로 구분                |
| **푸터 선택사항** | 푸터가 있다면 본문(또는 설명)과 빈 줄로 구분     |
| **대소문자**      | `BREAKING CHANGE`만 대문자, 나머지는 자유        |
| **최소 요구사항** | `<type>: <description>` 형태만으로도 유효한 커밋 |

## 시맨틱 버전 매핑

| 커밋 타입                 | 버전 증가     | 설명                    |
| ------------------------- | ------------- | ----------------------- |
| `fix`                     | PATCH (0.0.X) | 버그 수정               |
| `feat`                    | MINOR (0.X.0) | 새 기능                 |
| `BREAKING CHANGE`         | MAJOR (X.0.0) | 호환성을 깨뜨리는 변경  |
| 기타 (`docs`, `style` 등) | 증가 없음     | 기능/버그와 무관한 변경 |

## 자동화 도구 연동

### 1. commitlint 설정

```bash
# 설치
bun add -D @commitlint/cli @commitlint/config-conventional

# .commitlintrc.js
module.exports = {
  extends: ['@commitlint/config-conventional'],
  rules: {
    'type-enum': [2, 'always', [
      'feat', 'fix', 'docs', 'style', 'refactor', 
      'perf', 'test', 'chore', 'ci', 'build', 'revert'
    ]]
  }
}
```

### 2. husky로 pre-commit 훅 설정

```bash
# 설치
bun add -D husky

# 설정
bunx husky init
echo "bunx commitlint --edit \$1" > .husky/commit-msg
```

### 3. package.json 스크립트

```json
{
  "scripts": {
    "commit": "git-cz",
    "lint:commit": "commitlint --from=HEAD~1"
  }
}
```

## 주요 장점

| 장점           | 설명                                   |
| -------------- | -------------------------------------- |
| **간단함**     | 헤더만으로도 충분한 정보 전달 가능     |
| **자동화**     | CHANGELOG 및 버전 자동 생성            |
| **명확성**     | 변경사항의 성격을 명확히 전달          |
| **일관성**     | 팀 전체의 일관된 커밋 메시지           |
| **추적성**     | 구조화된 히스토리로 변경사항 추적 용이 |
| **CI/CD 연동** | 빌드/배포 프로세스 자동 트리거         |

## 자주 묻는 질문

| 질문                                      | 답변                                                            |
| ----------------------------------------- | --------------------------------------------------------------- |
| **본문과 푸터를 언제 사용해야 하나요?**   | 헤더만으로 설명이 부족할 때만 사용. 대부분의 커밋은 헤더면 충분 |
| **초기 개발 단계에서도 사용해야 하나요?** | 네, 이미 출시된 것처럼 진행하는 것을 권장                       |
| **대소문자는 어떻게 하나요?**             | 일관성만 유지하면 자유롭게 사용 가능                            |
| **여러 타입에 해당하는 커밋은?**          | 가능하면 여러 커밋으로 분리                                     |
| **모든 기여자가 따라야 하나요?**          | 아니요, 스쿼시 머지로 메인테이너가 정리 가능                    |
| **잘못된 타입을 사용했다면?**             | 머지 전: `git rebase -i`로 수정, 머지 후: 도구에 따라 다름      |
| **revert 커밋은 어떻게 작성하나요?**      | `revert: <원본 커밋 제목>` 형식으로 작성                        |
| **자잘한 코드 개선은 어떤 타입인가요?**   | `refactor` (구조 개선) → `style` (포맷팅) → `chore` (기타) 순   |

## 🔧 자잘한 코드 개선 타입 선택 가이드

### 상황별 타입 결정

| 수정 내용         | 사용 타입  | 이유           | 예시                                          |
| ----------------- | ---------- | -------------- | --------------------------------------------- |
| **함수 분리**     | `refactor` | 코드 구조 개선 | `refactor: 중복 로직을 유틸 함수로 추출`      |
| **조건문 단순화** | `refactor` | 로직 개선      | `refactor: 복잡한 if문을 삼항연산자로 단순화` |
| **클래스 분할**   | `refactor` | 구조 재편성    | `refactor: 큰 컴포넌트를 작은 단위로 분할`    |
| **들여쓰기 수정** | `style`    | 순수 포맷팅    | `style: 들여쓰기를 2칸에서 4칸으로 변경`      |
| **공백 정리**     | `style`    | 포맷팅 정리    | `style: 불필요한 공백 제거`                   |
| **변수명 개선**   | `chore`    | 코드 정리      | `chore: 변수명 temp를 temperature로 변경`     |
| **import 정리**   | `chore`    | 유지보수 작업  | `chore: 사용하지 않는 import 제거`            |
| **주석 정리**     | `chore`    | 코드 정리      | `chore: 오래된 주석 제거`                     |

### 🤔 헷갈릴 때 판단 기준

```
1. 코드의 동작이 바뀌나요? 
   → 바뀜: feat/fix 고려
   → 안 바뀜: 2번으로

2. 코드 구조나 로직이 개선되나요?
   → 예: refactor
   → 아니오: 3번으로

3. 순수하게 포맷팅만 바뀌나요?
   → 예: style  
   → 아니오: chore
```

### 💡 실무 팁

- **정말 구조가 바뀌는가?** → `refactor`
- **단순 정리/정돈인가?** → `chore` 
- **포맷팅만 바뀌는가?** → `style`
- **너무 고민하지 않기** - 일관성이 더 중요
- **팀 내 합의**를 통해 애매한 경우 룰 정하기

## 실제 사용 예시

### 일반적인 형태 (헤더만, 권장)

| 시나리오          | 커밋 메시지                         |
| ----------------- | ----------------------------------- |
| **새 기능**       | `feat: 다크 모드 토글 추가`         |
| **버그 수정**     | `fix: 로그인 버튼 클릭 오류 수정`   |
| **문서 업데이트** | `docs: 설치 가이드 추가`            |
| **스타일 변경**   | `style: 코드 포맷팅 적용`           |
| **리팩토링**      | `refactor: 사용자 서비스 로직 정리` |
| **되돌리기**      | `revert: feat: 실험적 기능 제거`    |

### 스코프 포함

| 시나리오           | 커밋 메시지                            |
| ------------------ | -------------------------------------- |
| **특정 모듈 수정** | `feat(auth): OAuth2 로그인 구현`       |
| **API 변경**       | `fix(api): 사용자 조회 응답 형식 수정` |
| **UI 컴포넌트**    | `feat(ui): 새로운 버튼 컴포넌트 추가`  |

### 호환성을 깨뜨리는 변경

| 시나리오        | 커밋 메시지                         |
| --------------- | ----------------------------------- |
| **주요 변경**   | `feat!: 새 API 구조로 마이그레이션` |
| **의존성 제거** | `chore!: Node 14 지원 중단`         |

### 복잡한 변경 (본문 + 푸터 포함)

| 시나리오           | 커밋 메시지                                                                                                                                                                                                     |
| ------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **상세 설명 필요** | `fix: 이미지 처리 메모리 누수 해결`<br><br>`가비지 컬렉션 문제를 수정하고 참조를 명시적으로 해제하도록 변경. 이로 인해 장시간 실행 시 메모리 사용량이 안정화됨.`<br><br>`Closes #123`<br>`Reviewed-by: 팀 리더` |

## 팀 적용 가이드

### 1단계: 팀 합의
- 사용할 커밋 타입 결정
- 스코프 명명 규칙 정의
- 예외 상황 처리 방법 합의

### 2단계: 도구 설정
- commitlint 설정 및 공유
- IDE 플러그인 설치 안내
- 자동화 스크립트 작성

### 3단계: 점진적 적용
- 새 프로젝트부터 적용
- 기존 프로젝트는 단계적 전환
- 정기적인 리뷰 및 개선

> 💡 팁: 80%의 커밋은 헤더만으로도 충분함. 본문과 푸터는 복잡한 변경사항이나 추가 컨텍스트가 필요할 때만 사용.

---

**참고 자료:**
- [Conventional Commits v1.0.0](https://www.conventionalcommits.org/)
- [commitlint 공식 문서](https://commitlint.js.org/)
- [Angular Commit Message Guidelines](https://github.com/angular/angular/blob/main/CONTRIBUTING.md#commit)

- 원칙 5: 명령조로 작성하되, `Fix`, `Add`, `Change` 등 구체적인 동사를 사용
- 원칙 6: 일관성을 유지
- 원칙 7: 팀의 컨벤션을 존중

##### 팁

- **완벽주의를 피하기** - 커밋은 자주, 작게 할수록 좋음.
- **너무 고민하지 않기** - 일관성이 더 중요
- **실수했다면?** - `git rebase -i` 또는 `git commit --amend`로 수정 가능

---